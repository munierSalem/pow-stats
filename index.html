<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Ski Area Stats Scatterplot</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    body {
      font-family: sans-serif;
      margin: 40px;
    }
    .axis-label {
      font-size: 14px;
      font-weight: bold;
    }
    .tooltip {
      position: absolute;
      background: white;
      border: 1px solid #aaa;
      padding: 8px;
      font-size: 12px;
      pointer-events: none;
      opacity: 0;
    }
    .filters {
      margin-bottom: 10px;
    }
    .filter-btn {
      display: inline-block;
      margin: 2px 5px;
      padding: 5px 10px;
      border-radius: 20px;
      border: 1px solid #ccc;
      cursor: pointer;
      font-size: 12px;
      font-weight: bold;
      background: #f8f8f8;
      transition: all 0.2s ease;
    }
    .filter-btn.active {
      color: white;
    }
  </style>
</head>
<body>
  <h2>Ski Area Size vs. Public Boundary</h2>
  <div id="chart-container"></div>

  <script type="module">
    import { ScatterPlot } from './ScatterPlot.js';

    // Color map
    const colorMap = {
      'Eastern Canada': "#FF6F00",
      'Midwest': "#00A2FF",
      'Northeast': "#00C853",
      'Pacific': "#FFD600",
      'Rockies': "#AA00FF",
      'Western Canada': "#D50000"
    };

    d3.csv("data/ski-stats.csv").then(data => {
      data.forEach(d => {
        d.public_boundary_area = +d.public_boundary_area || 0;
        d.advertised_acres = +d.advertised_acres || 0;
        d.ratio = d.public_boundary_area > 0 ? d.advertised_acres / d.public_boundary_area : 0;
      });

      const plot = new ScatterPlot({
        containerId: "chart-container",
        data: data,
        xField: "public_boundary_area",
        yField: "ratio",
        xLabel: "Public Boundary Area",
        yLabel: "Advertised Skiable Acres / Boundary Area",
        breakoutField: "region",
        pointRadius: 5,
        tooltipArgs: {
          text: d => `
            <strong>${d.resort_name}</strong><br/>
            ${d.state}, ${d.region}<br/>
            Boundary Area: ${d.public_boundary_area}<br/>
            Advertised Acres: ${d.advertised_acres}<br/>
            Ratio: ${d.ratio.toFixed(2)}
          `
        },
        width: 900,
        height: 600,
        colorMap: colorMap,
      });

      plot.updatePlot();
    });
  </script>
</body>
</html>
